<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.0.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-微信小程序" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/03/01/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/" class="article-date">
  <time class="dt-published" datetime="2022-03-01T12:19:32.699Z" itemprop="datePublished">2022-03-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <hr>
<h2 id="title-wsxcx"><a href="#title-wsxcx" class="headerlink" title="title:wsxcx"></a>title:wsxcx</h2><h2 id="什么是微信小程序？"><a href="#什么是微信小程序？" class="headerlink" title="什么是微信小程序？"></a>什么是微信小程序？</h2><p>微信小程序，简称小程序。英文名<code>mini program</code>，是一种不需要下载安装就可以直接使用的应用。他实现了触手可及的梦想。用户扫一扫或搜一下就可以直接打开应用。</p>
<h2 id="为什么是微信小程序"><a href="#为什么是微信小程序" class="headerlink" title="为什么是微信小程序"></a>为什么是微信小程序</h2><ol>
<li>微信有海量用户</li>
<li>推广app或公众号成本太高</li>
<li>开发适配成本低</li>
<li>容易小规模试错，然后快速迭代</li>
<li>跨平台</li>
</ol>
<h2 id="历史"><a href="#历史" class="headerlink" title="历史"></a>历史</h2><ol>
<li>2016年1月11日，张小龙，微信内部研究新的形态，<code>应用号</code>，后改名<code>小程序</code>。</li>
<li>2016年8月12日，开始内测</li>
<li>2017年1月9日，上线</li>
</ol>
<p>#环境规范</p>
<ol>
<li><p>注册账号</p>
<p><a href="https://link.juejin.cn/?target=https://mp.weixin.qq.com/">mp.weixin.qq.com&#x2F;</a> (帐号信息 — 邮箱激活 — 信息登记)</p>
</li>
<li><p>获取id</p>
<p>APPID （<a href="https://link.juejin.cn/?target=https://mp.weixin.qq.com/wxamp/devprofile/get_profile?token=942994743&lang=zh_CN">登录微信公众平台</a> —&gt; 开发 —&gt; 开发设置）</p>
</li>
</ol>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/25d7088598ce45b3a304a999018c1fe9~tplv-k3u1fbpfcp-watermark.awebp" alt="&lt;img src=&quot;/Users/cly/Library/Application Support/typora-user-images/image-20200707110747168.png&quot; alt=&quot;image-20200707110747168&quot; style=&quot;zoom:80%;&quot; /&gt;"></p>
<ol>
<li><p>开发者工具</p>
<p><a href="https://link.juejin.cn/?target=https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html">微信开发者工具下载</a></p>
</li>
</ol>
<h1 id="小程序开发者工具"><a href="#小程序开发者工具" class="headerlink" title="小程序开发者工具"></a>小程序开发者工具</h1><p> <a href="https://link.juejin.cn/?target=https://developers.weixin.qq.com/miniprogram/dev/devtools/devtools.html">开发者工具介绍</a></p>
<p> 快捷键：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1. ctrl + shift + F (搜索)</span><br><span class="line">2. alt + shift + F (代码格式化---VSCode)</span><br></pre></td></tr></table></figure>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6e8eee16d0ca4e529f078e6ef2b553e9~tplv-k3u1fbpfcp-watermark.awebp" alt="&lt;img src=&quot;/Users/cly/Library/Application Support/typora-user-images/image-20200707112457994.png&quot; alt=&quot;image-20200707112457994&quot; style=&quot;zoom:50%;&quot; /&gt;"></p>
<h1 id="小程序原生框架"><a href="#小程序原生框架" class="headerlink" title="小程序原生框架"></a>小程序原生框架</h1><p>小程序的原生框架，mina框架 <a href="https://link.juejin.cn/?target=https://developers.weixin.qq.com/miniprogram/dev/framework/MINA.html">框架详情</a></p>
<h2 id="小程序配置文件（写配置文件在微信开发者工具工具写，有提示）"><a href="#小程序配置文件（写配置文件在微信开发者工具工具写，有提示）" class="headerlink" title="小程序配置文件（写配置文件在微信开发者工具工具写，有提示）"></a>小程序配置文件（写配置文件在微信开发者工具工具写，有提示）</h2><ol>
<li><p>app.json <a href="https://link.juejin.cn/?target=https://developers.weixin.qq.com/miniprogram/dev/framework/config.html%23%E5%85%A8%E5%B1%80%E9%85%8D%E7%BD%AE">全局配置文件</a></p>
<p>配置全局文件</p>
<ul>
<li>pages：添加要创建的文件项，保存后就会自动生成文件</li>
<li><a href="https://link.juejin.cn/?target=https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/page.html">windows</a>：设置小程序的状态栏，导航条，标题窗口颜色</li>
</ul>
</li>
</ol>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/920738a3ebb54b7aae722ee957f01039~tplv-k3u1fbpfcp-watermark.awebp" alt="&lt;img src=&quot;/Users/cly/Library/Application Support/typora-user-images/image-20200707142609082.png&quot; alt=&quot;image-20200707142609082&quot; style=&quot;zoom:50%;&quot; /&gt;"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">* [tabBar](https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/app.html)</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>page.json <a href="https://link.juejin.cn/?target=https://developers.weixin.qq.com/miniprogram/dev/framework/config.html%23%E5%85%A8%E5%B1%80%E9%85%8D%E7%BD%AE">页面配置文件</a> 3. <a href="https://link.juejin.cn/?target=https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/sitemap.html">sitemap</a></li>
</ol>
<h1 id="小程序的模板语法"><a href="#小程序的模板语法" class="headerlink" title="小程序的模板语法"></a>小程序的模板语法</h1><p>WXML —&gt; HTML (结合基础组件，事件系统，构件出页面结构)</p>
<ol>
<li><p>相当于 ，行内标签，不会换行</p>
</li>
<li><p>相当于</p>
<p>，块级元素，会换行</p>
</li>
</ol>
<h2 id="数据绑定"><a href="#数据绑定" class="headerlink" title="数据绑定"></a>数据绑定</h2>

<ol>
<li><p>运算 –&gt; 表达式（ 数值计算，字符串拼接，三元表达式）</p>
</li>
<li><p>列表循环 （wx:for）</p>
<p>wx:key绑定的是数组中的为唯一属性，wx:key&#x3D;*this表示数组是<code>普通数组</code>，<code>*this</code>是循环项</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:for</span>=<span class="string">&quot;&#123;&#123; person &#125;&#125;&quot;</span> </span></span><br><span class="line"><span class="tag"><span class="attr">wx:for-item</span>=<span class="string">&quot;item&quot;</span> </span></span><br><span class="line"><span class="tag"><span class="attr">wx:for-index</span>=<span class="string">&quot;index&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">wx:key</span>=<span class="string">&quot;id&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">    索引： &#123;&#123; index &#125;&#125;</span><br><span class="line">    名称： &#123;&#123; item.name &#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>标签 —&gt; 占位标签</p>
</li>
<li><p>条件渲染（wx:if）（wx:if, wx:elif, wx:else） (hidden 属性是通过添加样式的方式来呈现的)</p>
<p>当标签不是频繁的切换使用if，频繁切换使用hidden</p>
</li>
</ol>
<h2 id="事件绑定"><a href="#事件绑定" class="headerlink" title="事件绑定"></a>事件绑定</h2><p>关键字：bind （bindinput，bindtap【点击事件】）</p>
<p>获取事件源对象的值：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">e.detail.value</span><br></pre></td></tr></table></figure>

<p>获取data中数据的值：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">this.data.属性名</span><br></pre></td></tr></table></figure>

<p>将事件源对象的值设置回data中：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> this.setData(&#123;</span><br><span class="line">        num: this.data.num + operation</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>事件绑定是不能直接传参，要通过自定义属性的方式传参（  ）：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;button bindtap=&quot;bandletap&quot; data-operation=&quot;&#123;&#123; 1 &#125;&#125;&quot;&gt;+&lt;/button&gt;</span><br><span class="line"></span><br><span class="line">bandletap(e) &#123;</span><br><span class="line">   // console.log(e);</span><br><span class="line">   const operation = e.currentTarget.dataset.operation;</span><br><span class="line">   this.setData(&#123;</span><br><span class="line">       num: this.data.num + operation</span><br><span class="line">   &#125;);</span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure>

<h2 id="样式"><a href="#样式" class="headerlink" title="样式"></a>样式</h2><h3 id="尺寸单位"><a href="#尺寸单位" class="headerlink" title="尺寸单位"></a>尺寸单位</h3><p>当屏幕宽度等于 750px 时，1px &#x3D; 1rpx</p>
<p>当屏幕宽度等于375px时， 1px &#x3D;0.5rpx</p>
<h3 id="样式导入只支持相对路径"><a href="#样式导入只支持相对路径" class="headerlink" title="样式导入只支持相对路径"></a>样式导入只支持相对路径</h3><h3 id="选择器（微信小程序不支持通配符）"><a href="#选择器（微信小程序不支持通配符）" class="headerlink" title="选择器（微信小程序不支持通配符）"></a>选择器（微信小程序不支持通配符）</h3><h1 id="小程序的内置组件"><a href="#小程序的内置组件" class="headerlink" title="小程序的内置组件"></a>小程序的内置组件</h1><p>小程序中常用的布局组件：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">view,text,rich-text,button,image,icon,swiper,radio,checkbox等。</span><br></pre></td></tr></table></figure>

<ol>
<li><p>view标签 相当于 div标签</p>
</li>
<li><p>text标签 只能嵌套text标签 长按文字可以复制【selectable】（只有这个标签有这个功能） 可以对回车,空格进行编码 (decode)</p>
</li>
<li><p>image标签 （打包上线的大小不能超过2M，使用图片的时候统一使用外网图片）</p>
<ol>
<li><p>图片存在默认的宽高（320px * 240px）</p>
</li>
<li><p>mode 决定 图片内容 和 图片标签 做适配</p>
<p>scaleToFill 默认值 不保持纵横比，拉伸至标签定义的宽高</p>
<p>aspectFit 保持宽高比，保证图片的长边完全显示（常用 轮播图）</p>
<p>aspectFill 短边完全显示</p>
<p>widthFix 宽度不变，高度自动变化，保持原宽高比不变</p>
<p>top，left，bottom，right 背景图定位</p>
</li>
<li><p>小程序中的图片 直接支持 懒加载</p>
<p>lazy-load 会自己判断 当图片出现在视口的上下三屏之内的时候，自己开始加载图片</p>
</li>
</ol>
</li>
<li><p>swiper标签 —》 轮播图</p>
<p>swiper高度 &#x3D; swiper的宽度 * 图片的高度 &#x2F; 原图的宽度</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">swiper</span> <span class="attr">autoplay</span> <span class="attr">interval</span>=<span class="string">&quot;1000&quot;</span> <span class="attr">circular</span> <span class="attr">indicator-dots</span>&gt;</span></span><br><span class="line">    // 图片存在默认宽高  320 * 240</span><br><span class="line">	<span class="tag">&lt;<span class="name">swiper-item</span>&gt;</span><span class="tag">&lt;<span class="name">image</span> <span class="attr">model</span>=<span class="string">&quot;widthFix&quot;</span> <span class="attr">src</span>=<span class="string">&quot;&quot;</span> /&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span><span class="tag">&lt;/<span class="name">swiper-item</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">swiper</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>navigator 导航组件 (块级元素，默认换行)</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">navigator</span> <span class="attr">url</span>=<span class="string">&quot;/pages/homepage/index&quot;</span> <span class="attr">open-type</span>=<span class="string">&quot;navigate&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>rich-text(富文本标签，将字符串解析成对应标签，相当于v-html)</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 1 标签字符串</span><br><span class="line"><span class="tag">&lt;<span class="name">rich-text</span> <span class="attr">nodes</span>=<span class="string">&quot;&#123;&#123; html &#125;&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">rich-text</span>&gt;</span></span><br><span class="line"></span><br><span class="line">// 2 对象数组</span><br><span class="line"><span class="tag">&lt;<span class="name">rich-text</span> <span class="attr">nodes</span>=<span class="string">&quot;&#123;&#123; html.model &#125;&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">rich-text</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>button 按钮</p>
<p>大小（size:mini&#x2F;default），颜色(type:default&#x2F;primary&#x2F;warn)，是否镂空（plain），是否在文字前有加载loading（loading），开发能力（opentype）</p>
<p>开放能力（opentype）:</p>
<ol>
<li><p>concat 直接打开 客服对话 功能，需要在小程序的后台配置</p>
<ol>
<li>将小程序的appid由测试号改为自己的appid</li>
<li>登录微信小程序官网，添加 客服 - 微信</li>
</ol>
</li>
<li><p>share 转发当前小程序到微信朋友中 ，不能把小程序转发到朋友圈中</p>
</li>
<li><p>getPhoneNumber 获取当前用户的手机号码，结合事件来使用，不是企业的小程序账号 没有权限来获取用户的手机号码</p>
</li>
<li><p>getUserInfo获取用户的个人信息</p>
</li>
<li><p>launchApp在 小程序 中直接打开 app</p>
</li>
<li><p>openSetting 打开小程序内置的授权页面</p>
<p>只会出现用户点击过的权限</p>
</li>
<li><p>feedback 打开小程序内置的意见反馈页面</p>
</li>
</ol>
</li>
<li><p>icon</p>
<p>type：类型 success，success_no_circle,info,warn,wating.success_no_circle,info,warn,waiting，cancel,downkload，search，clear</p>
<p>size：大小 number &#x2F; string</p>
<p>color：颜色</p>
</li>
<li><p>radio 单选框</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">radio-group</span> <span class="attr">bindchange</span>=<span class="string">&quot;handleChange&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">radio</span> <span class="attr">color</span>=<span class="string">&quot;red&quot;</span> <span class="attr">value</span>=<span class="string">&quot;male&quot;</span>&gt;</span>男<span class="tag">&lt;/<span class="name">radio</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">radio</span> <span class="attr">color</span>=<span class="string">&quot;red&quot;</span> <span class="attr">value</span>=<span class="string">&quot;female&quot;</span>&gt;</span>女<span class="tag">&lt;/<span class="name">radio</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">radio-group</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span>&gt;</span>选中的是： &#123;&#123; gender &#125;&#125; <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"></span><br><span class="line">data：&#123;</span><br><span class="line">	gender: &quot;&quot;</span><br><span class="line">&#125;,</span><br><span class="line">handleChange(e) &#123;</span><br><span class="line">	// 获取单选框选中的值</span><br><span class="line">	let gender = e.detail.value;</span><br><span class="line">	// 把值赋值给data中的数据</span><br><span class="line">	this.setData(&#123;</span><br><span class="line">		gender // 相当于 gender：gender</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>checkbox 多选框</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">checkbox-group</span> <span class="attr">bindchange</span>=<span class="string">&quot;handleChange&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">checkbox</span> <span class="attr">value</span>=<span class="string">&quot;&#123;&#123; item.value &#125;&#125;&quot;</span> <span class="attr">wx:for</span>=<span class="string">&quot;&#123;&#123; list &#125;&#125;&quot;</span> <span class="attr">wx:key</span>=<span class="string">&quot;id&quot;</span>&gt;</span>&#123;&#123; item.name &#125;&#125;		     <span class="tag">&lt;/<span class="name">checkbox</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">checkbox-group</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span>&gt;</span>选中的是： &#123;&#123; checkedList &#125;&#125; <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"></span><br><span class="line">checkedList:[]</span><br><span class="line">handleChange(e) &#123;</span><br><span class="line">	let checkedList = e.detail.value;</span><br><span class="line">	this.setData(&#123;</span><br><span class="line">		checkedList</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="小程序的生命周期"><a href="#小程序的生命周期" class="headerlink" title="小程序的生命周期"></a>小程序的生命周期</h1><h2 id="应用生命周期"><a href="#应用生命周期" class="headerlink" title="应用生命周期"></a>应用生命周期</h2><p>触发过程：</p>
<p>onLaunch -》 onShow</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">App</span>(&#123;</span><br><span class="line">    <span class="comment">// 1 应用 第一次启用的时候触发</span></span><br><span class="line">    <span class="title function_">onLaunch</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// 在应用第一次启动的时候 获取用户信息</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 2 应用 被用户看到的时候触发</span></span><br><span class="line">    <span class="title function_">onShow</span>(<span class="params"></span>) &#123;</span><br><span class="line">    	<span class="comment">// 常用于小程序界面之间的切换</span></span><br><span class="line">    	<span class="comment">// 对应用的数据或者页面的效果进行重置</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 3 应用 被隐藏的时候触发</span></span><br><span class="line">	<span class="title function_">onHide</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// 暂停或者清楚定时器</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 4 应用 代码发生报错的时候  执行</span></span><br><span class="line">	<span class="title function_">onError</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// 在应用发生代码报错的时候，收集用户的错误信息，通过异步请求，将错误信息发送到后台去</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 5 页面找不到的时候就会触发</span></span><br><span class="line">	<span class="comment">// 应用第一次启动的时候，如果找不到第一个入口页面，才会触发</span></span><br><span class="line">	<span class="title function_">onPageNotFound</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// 如果页面不存在了  通过js的方式来重新跳转页面  重新跳转到第二个首页</span></span><br><span class="line">        <span class="comment">// 不能跳转到tabbar页面  导航组件类似</span></span><br><span class="line">        wx.<span class="title function_">navigateTo</span>(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">&quot;/pages/demo02/index&quot;</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<h2 id="页面生命周期"><a href="#页面生命周期" class="headerlink" title="页面生命周期"></a>页面生命周期</h2><p>onLoad -&gt; onShow -&gt; onReady</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Page</span>(&#123;</span><br><span class="line">    <span class="attr">data</span>: &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">onLoad</span>: <span class="keyword">function</span>(<span class="params">options</span>) &#123;</span><br><span class="line">        <span class="comment">// onload发送异步请求来初始化页面数据</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">onShow</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// 页面显示加载</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">onReady</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// 页面初次渲染完成</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">onHide</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// 页面隐藏时加载  一个页面跳转到另外一个页面也会触发onHide事件</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">onUnload</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// 页面卸载  也可以通过超链接   关闭当前页面就会触发onUnload事件</span></span><br><span class="line">        <span class="comment">// &lt;navigator url=&quot;/pages/demo01/demo01&quot; open-typr-redirect&gt;demo01&lt;/navigator&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 关闭当前页面就代表着卸载页面</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">onPullDownRefresh</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// 监听用户下拉事件  &quot;enablePullDownRefresh&quot;:true</span></span><br><span class="line">        <span class="comment">//  页面效果的重新加载</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">onReachBotton</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// 监听用户上拉触底事件   【需要让页面出现上下的滚动才行】</span></span><br><span class="line">        <span class="comment">// 常用于  上拉加载下一页操作</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">onShareAppMessage</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// 用户点击右上角转发</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">onPageScroll</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// 页面滚动就触发</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">onResize</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// 页面尺寸发生变化的时候触发   </span></span><br><span class="line">        <span class="comment">// 常指 手机横屏竖屏的时候  触发    </span></span><br><span class="line">        <span class="comment">//  app.json中添加   &quot;pageOrientation&quot;:&quot;auto&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">onTabItemTap</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// 1. 当前页面必须为tabbar页面</span></span><br><span class="line">        <span class="comment">// 2. 点击的是自己的tab  item的时候才触发</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h1 id="小程序自定义组件"><a href="#小程序自定义组件" class="headerlink" title="小程序自定义组件"></a>小程序自定义组件</h1><p>步骤：</p>
<ol>
<li><p>创建</p>
</li>
<li><p>声明（那个页面要使用自定义组件，就在那个页面的json文件中声明）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;usingComponents&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;Tabs&quot;</span>: <span class="string">&quot;../../components/Tabs/Tabs&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Tabs</span>&gt;</span><span class="tag">&lt;/<span class="name">Tabs</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ol>
<p>注意：</p>
<ul>
<li><p>页面的.js文件中，存放事件回调函数的时候，存放在data同层级下</p>
</li>
<li><p>组件的.js文件中，存放时间的回调函数的时候，存放在methods中</p>
</li>
<li><p>在小程序中不要直接通过<code>this.data.x.</code>来修改数组的值（建议先拷贝一份数组，然后再对拷贝的数组进行修改）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> tabs = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">tabs</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> tabs = <span class="variable language_">this</span>.<span class="property">data</span>;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="组件之间的传值"><a href="#组件之间的传值" class="headerlink" title="组件之间的传值"></a>组件之间的传值</h2><h3 id="父组件向子组件传值"><a href="#父组件向子组件传值" class="headerlink" title="父组件向子组件传值"></a>父组件向子组件传值</h3><p>通过 <code>标签的属性</code>来传递的：</p>
<ol>
<li><p>父组件传递</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">Tabs</span> aaa=<span class="string">&quot;123&quot;</span>&gt;&lt;/<span class="title class_">Tabs</span>&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>子组件接收</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Component</span>(&#123;</span><br><span class="line">    <span class="comment">// 里面存放的是要从父组件中接收的数据</span></span><br><span class="line">    <span class="attr">properties</span>: &#123;</span><br><span class="line">        <span class="comment">// 要接受的数据的名称</span></span><br><span class="line">        <span class="attr">aaa</span>:&#123;</span><br><span class="line">            <span class="comment">//type 接收数据的类型</span></span><br><span class="line">            <span class="attr">type</span>: <span class="title class_">String</span>,</span><br><span class="line">            <span class="comment">//value 默认值</span></span><br><span class="line">            <span class="attr">value</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>子组件使用父组件中传递过来的数据</p>
<p>将接收过来的数据当作本身data中的数据来使用</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span>&gt;</span>&#123;&#123; aaa &#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="子组件向父组件传值"><a href="#子组件向父组件传值" class="headerlink" title="子组件向父组件传值"></a>子组件向父组件传值</h3><p>通过<code>事件</code>来传递的。</p>
<p>tab切换栏，点击切换。</p>
<ol>
<li>绑定点击事件 需要在methods中绑定</li>
<li>获取被点击的索引</li>
<li>获取原数组</li>
<li>对数组循环<ol>
<li>给每一个循环项 选中属性 改为 false</li>
<li>给 当前的索引 的 项 添加激活选中效果</li>
</ol>
</li>
<li>点击事件触发的时候，触发父组件中的自定义事件同时传递给父组件<ol>
<li>this.triggerEvent(“父组件自定义事件的名称”，要传递的参数)</li>
</ol>
</li>
</ol>
<p>Tabs页面中：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> </span></span><br><span class="line"><span class="tag">      <span class="attr">wx:for</span>=<span class="string">&quot;&#123;&#123;tabs&#125;&#125;&quot;</span> </span></span><br><span class="line"><span class="tag">      <span class="attr">wx:key</span>=<span class="string">&quot;id&quot;</span> </span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">&quot;title_item &#123;&#123;item.isActive?&#x27;active&#x27;:&#x27;&#x27;&#125;&#125;&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">bindtap</span>=<span class="string">&quot;hanldeItemTap&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">data-index</span>=<span class="string">&quot;&#123;&#123;index&#125;&#125;&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span>&#123;&#123; item.name &#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;tabs_content&quot;</span>&gt;</span></span><br><span class="line">    // 占位符  传递的参数会替换掉 </span><br><span class="line">	<span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>子组件的js文件中：(这样写不能改变组件内部的数据，只是基于样式的改变，不是基于功能)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">hanldeItemTap</span>(<span class="params">e</span>) &#123;</span><br><span class="line">        <span class="comment">// 获取索引</span></span><br><span class="line">        <span class="keyword">const</span> &#123;index&#125; = e.<span class="property">currentTarget</span>.<span class="property">dataset</span>;</span><br><span class="line">        <span class="comment">// let &#123;tabs&#125; = this.data;</span></span><br><span class="line">        <span class="comment">// tabs.forEach((v,i) =&gt; i===index?v.isActive=true:v.isActive=false);</span></span><br><span class="line">        <span class="comment">// 修改data中的数据</span></span><br><span class="line">        <span class="comment">// this.setData(&#123;</span></span><br><span class="line">        <span class="comment">//    tabs</span></span><br><span class="line">        <span class="comment">// &#125;)</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 触发父组件中的自定义事件同时传递给父组件</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">triggerEvent</span>(<span class="string">&quot;itemChange&quot;</span>, &#123;</span><br><span class="line">            index</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在<strong>父组件</strong>中的自定义组件中添加自定义事件：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Tabs</span> <span class="attr">binditemChange</span>=<span class="string">&quot;handleItemChange&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">block</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;tabs[0].isActive&#125;&#125;&quot;</span>&gt;</span>1<span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">block</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;tabs[1].isActive&#125;&#125;&quot;</span>&gt;</span>2<span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">block</span> <span class="attr">wx:else</span>&gt;</span>3<span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Tabs</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>父组件</strong>的js中：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">data</span>: &#123;</span><br><span class="line">    <span class="attr">tabs</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">id</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&quot;首页&quot;</span>,</span><br><span class="line">            <span class="attr">isActive</span>: <span class="literal">true</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">id</span>: <span class="number">2</span>,</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&quot;待发货&quot;</span>,</span><br><span class="line">            <span class="attr">isActive</span>: <span class="literal">false</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">id</span>: <span class="number">3</span>,</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&quot;待付款&quot;</span>,</span><br><span class="line">            <span class="attr">isActive</span>: <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 自定义事件   接收子组件传递的数据的</span></span><br><span class="line"><span class="title function_">handleItemChange</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="comment">// 接收传递过来的参数</span></span><br><span class="line">    <span class="keyword">const</span> &#123;index&#125; = e.<span class="property">detail</span>;</span><br><span class="line">    <span class="comment">// 拿到原数组</span></span><br><span class="line">    <span class="keyword">let</span> &#123;tabs&#125; = <span class="variable language_">this</span>.<span class="property">data</span>;</span><br><span class="line">    tabs.<span class="title function_">forEach</span>(<span class="function">(<span class="params">v,i</span>) =&gt;</span> i===index?v.<span class="property">isActive</span>=<span class="attr">true</span>:v.<span class="property">isActive</span>=<span class="literal">false</span>);</span><br><span class="line">    <span class="comment">// 修改data中的数据</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">        tabs</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="其他属性"><a href="#其他属性" class="headerlink" title="其他属性"></a>其他属性</h2><table>
<thead>
<tr>
<th>定义段</th>
<th>类型</th>
<th></th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>properties</td>
<td>Object Map</td>
<td></td>
<td>组件的对外属性，是属性名，是属性设置的映射表</td>
</tr>
<tr>
<td>data</td>
<td>Object</td>
<td></td>
<td>常用于父组件向子组件传值，子组件接收父组件的值</td>
</tr>
<tr>
<td>observers</td>
<td>Object</td>
<td></td>
<td>监听properties和data的数据变化</td>
</tr>
<tr>
<td>methods</td>
<td>Object</td>
<td></td>
<td>组件的方法</td>
</tr>
<tr>
<td>created</td>
<td>Function</td>
<td></td>
<td>组件的生命周期函数（组件实例刚刚被被创建时执行）此时不能调用setData</td>
</tr>
<tr>
<td>attached</td>
<td>Function</td>
<td></td>
<td>组件实例进入页面节点树时执行</td>
</tr>
<tr>
<td>ready</td>
<td>Function</td>
<td></td>
<td>组件布局完成时执行</td>
</tr>
<tr>
<td>moved</td>
<td>Function</td>
<td></td>
<td>移动执行</td>
</tr>
<tr>
<td>detached</td>
<td>Function</td>
<td></td>
<td>移除执行</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h1 id="项目"><a href="#项目" class="headerlink" title="项目"></a>项目</h1><ol>
<li>首页</li>
<li>商品列表</li>
<li>购物车</li>
<li>授权页面</li>
<li>商品搜索</li>
<li>商品收藏</li>
<li>商品分类</li>
<li>商品详情</li>
<li>结算</li>
<li>订单列表</li>
<li>个人中心</li>
<li>意见反馈</li>
</ol>
<h2 id="小程序的第三方框架"><a href="#小程序的第三方框架" class="headerlink" title="小程序的第三方框架"></a>小程序的第三方框架</h2><ol>
<li>腾讯 wepy 类似于 vue</li>
<li>美团 mpvue 类似于 vue</li>
<li>京东 taro 类似于 react</li>
<li>滴滴 chameleon</li>
<li>uni-app 类似于 vue</li>
<li>原生框架 MINA</li>
</ol>
<h2 id="使用阿里字体图标库"><a href="#使用阿里字体图标库" class="headerlink" title="使用阿里字体图标库"></a>使用阿里字体图标库</h2><ol>
<li><p>在阿里图标官网，将要使用的图标，加入购物车</p>
</li>
<li><p>将图标，加入项目</p>
</li>
<li><p>小程序 pyg —》 Font class（通过类的方式来使用图标） —》 查看在线链接</p>
</li>
<li><p>在项目的styles文件夹中，创建<code>iconfont.wxss</code>文件</p>
</li>
<li><p>打开链接，将链接中的内容复制到<code>iconfont.wxss</code>文件中</p>
</li>
<li><p>使用字体图标库中的字体</p>
<ol>
<li><p>在全局wxss文件中，引入wxss文件</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@import &quot;./styles/iconfont.wxss&quot;</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;iconfont icon-shoucang&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
<h2 id="tabBar"><a href="#tabBar" class="headerlink" title="tabBar"></a>tabBar</h2><p><strong>在app.json中配置</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">tbaBar</span>: &#123;</span><br><span class="line">    <span class="string">&quot;color&quot;</span>: <span class="string">&quot;&quot;</span>,	<span class="comment">//未选中的字体的颜色</span></span><br><span class="line">    <span class="string">&quot;selectedColor&quot;</span>: <span class="string">&quot;&quot;</span>,	<span class="comment">//选中后的字体的颜色</span></span><br><span class="line">    <span class="string">&quot;backgroundColor&quot;</span>: <span class="string">&quot;&quot;</span>,  <span class="comment">// 背景色</span></span><br><span class="line">    <span class="string">&quot;position&quot;</span>: <span class="string">&quot;&quot;</span>,	<span class="comment">//定位</span></span><br><span class="line">    <span class="string">&quot;borderStyle&quot;</span>: <span class="string">&quot;&quot;</span>,   <span class="comment">//边框样式 </span></span><br><span class="line">    <span class="string">&quot;list&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;pagePath&quot;</span>: <span class="string">&quot;&quot;</span>,   <span class="comment">// 页面的路径</span></span><br><span class="line">            <span class="string">&quot;text&quot;</span>: <span class="string">&quot;&quot;</span>,   <span class="comment">// 标题的名称</span></span><br><span class="line">            <span class="string">&quot;iconPath&quot;</span>: <span class="string">&quot;&quot;</span>,   <span class="comment">// 未选中的图标路径</span></span><br><span class="line">            <span class="string">&quot;selectedIconPath&quot;</span>: <span class="string">&quot;&quot;</span>   <span class="comment">// 选中后的图标的路径</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="页面样式的初始化"><a href="#页面样式的初始化" class="headerlink" title="页面样式的初始化"></a>页面样式的初始化</h2><p><strong>注意：在小程序中是不支持 通配符（*）的</strong></p>
<p>在<code>app.wxss</code>文件中</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">page,view,text,swiper,swiper-item,image,navigator &#123;</span><br><span class="line">	padding: 0;</span><br><span class="line">	margin: 0;</span><br><span class="line">	box-sizing: border-box;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">	主题颜色</span><br><span class="line">	1. less 中是存在  变量  的</span><br><span class="line">	2. 原生的css和wxss 也是支持 css的</span><br><span class="line">*/</span><br><span class="line">page &#123;</span><br><span class="line">	--themeColor: #eb4500;</span><br><span class="line">	// 设计稿大小为 375px 时,1px = 2rpx,14px = 28rpx</span><br><span class="line">	font-size: 28rpx;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>使用主题颜色:</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">view &#123;</span><br><span class="line">	color: var(--themeColor);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="头部"><a href="#头部" class="headerlink" title="头部"></a>头部</h2><p>设置主题色:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;window&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;backgroundTextStyle&quot;</span>: <span class="string">&quot;light&quot;</span>,   <span class="comment">// 字体颜色</span></span><br><span class="line">    <span class="string">&quot;navigatorBarBackgroundColor&quot;</span>: <span class="string">&quot;#2b4500&quot;</span>,  <span class="comment">// 背景色</span></span><br><span class="line">    <span class="string">&quot;navigatorBarText&quot;</span>: <span class="string">&quot;唯品会&quot;</span>,  <span class="comment">// 字体提示</span></span><br><span class="line">    <span class="string">&quot;navigatorBarTextStyle&quot;</span>: <span class="string">&quot;white&quot;</span>,  <span class="comment">// 字体样式    </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="使用接口数据"><a href="#使用接口数据" class="headerlink" title="使用接口数据"></a>使用接口数据</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Page</span>(&#123;</span><br><span class="line">    <span class="attr">data</span>: &#123;</span><br><span class="line">        <span class="attr">swiperList</span>: []</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 页面加载事件</span></span><br><span class="line">    <span class="attr">onLoad</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        	1. 发送异步请求 获取使用的数据</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        wx.<span class="title function_">request</span>(&#123;</span><br><span class="line">        	<span class="attr">url</span>: <span class="string">&#x27;&#x27;</span>,  <span class="comment">// 接口地址</span></span><br><span class="line">        	<span class="attr">success</span>: <span class="function">(<span class="params">result</span>) =&gt;</span> &#123;</span><br><span class="line">        		<span class="comment">// 请求成功 给swiperList数组赋值</span></span><br><span class="line">        		<span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">        			<span class="attr">swiperList</span>: result.<span class="property">data</span>.<span class="property">message</span></span><br><span class="line">        		&#125;)</span><br><span class="line">        	&#125;</span><br><span class="line">        	</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        	wx.request异步请求太多了就会产生   回调地狱   的问题</span></span><br><span class="line"><span class="comment">        	</span></span><br><span class="line"><span class="comment">        	解决方法:  es6中的promise</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><strong>请求报错(两种解决方法):</strong></p>
<ol>
<li>在小程序 <code>详情</code> 界面 勾选上 <code>不校验合法域名,web-view(业务域名),TLS版本以及HTTPS证书</code></li>
<li>配置请求接口 见 <strong>8.7.将小程序请求的域名添加到后台</strong></li>
</ol>
<h2 id="解决回调地狱的问题-es6的promise"><a href="#解决回调地狱的问题-es6的promise" class="headerlink" title="解决回调地狱的问题(es6的promise)"></a>解决回调地狱的问题(es6的promise)</h2><p>在项目的request文件夹中创建<code>index.js</code>文件</p>
<p><strong>通过封装方法,然后调用函数传递参数的方式来使用</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 同时发送异步代码的次数</span></span><br><span class="line"><span class="keyword">let</span> ajaxTime=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">request</span>=(<span class="params">params</span>) =&gt; &#123;</span><br><span class="line">    ajaxTime++;</span><br><span class="line">    <span class="comment">// 数据加载效果</span></span><br><span class="line">    wx.<span class="title function_">showLoding</span>(&#123;</span><br><span class="line">       <span class="attr">title</span>: <span class="string">&quot;加载中&quot;</span>,</span><br><span class="line">        <span class="attr">mask</span>: <span class="literal">true</span></span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        wx.<span class="title function_">request</span>(&#123;</span><br><span class="line">            <span class="comment">// 解构传递的参数</span></span><br><span class="line">            ...params,</span><br><span class="line">            <span class="attr">success</span>: <span class="function">(<span class="params">result</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="title function_">resolve</span>(result);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">faile</span>: <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">            	<span class="title function_">reject</span>(err);</span><br><span class="line">        	&#125;,</span><br><span class="line">            <span class="comment">// 不管是成功还是失败都会调用这个函数</span></span><br><span class="line">            <span class="attr">complete</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">                ajaxTime--;</span><br><span class="line">                <span class="keyword">if</span>(ajaxTime === <span class="number">0</span>) &#123;</span><br><span class="line">                   <span class="comment">// 关闭正在等待的图标</span></span><br><span class="line">                	wx.<span class="title function_">hideLoading</span>();</span><br><span class="line">                &#125;                </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>使用封装好的请求方法:</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  引入封装文件 (注意: 一定要把路径补全)</span></span><br><span class="line"><span class="keyword">import</span> &#123; request &#125; <span class="keyword">from</span> <span class="string">&#x27;../../request/index.js&#x27;</span>;  <span class="comment">// 这里引入的是封装的request函数</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Page</span>(&#123;</span><br><span class="line">    <span class="attr">data</span>: &#123;</span><br><span class="line">        <span class="attr">swiperList</span>: []</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 页面加载事件</span></span><br><span class="line">    <span class="attr">onLoad</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        	1. 发送异步请求 获取使用的数据</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">            wx.request(&#123;</span></span><br><span class="line"><span class="comment">                url: &#x27;&#x27;,  // 接口地址</span></span><br><span class="line"><span class="comment">                success: (result) =&gt; &#123;</span></span><br><span class="line"><span class="comment">                    // 请求成功 给swiperList数组赋值</span></span><br><span class="line"><span class="comment">                    this.setData(&#123;</span></span><br><span class="line"><span class="comment">                        swiperList: result.data.message</span></span><br><span class="line"><span class="comment">                    &#125;)</span></span><br><span class="line"><span class="comment">                &#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">            &#125;);</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        	wx.request异步请求太多了就会产生   回调地狱   的问题</span></span><br><span class="line"><span class="comment">        	</span></span><br><span class="line"><span class="comment">        	解决方法:  es6中的promise</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 调用方法</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">getSwiperList</span>();</span><br><span class="line">        </span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 调用封装好的方法</span></span><br><span class="line">    <span class="title function_">getSwiperList</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">//  这里填充的数据会替换掉request方法中的...params,</span></span><br><span class="line">        <span class="title function_">request</span>(&#123; <span class="attr">url</span>: <span class="string">&#x27;htltps://api/zbtbs/home/swiperList&#x27;</span>&#125;); </span><br><span class="line">        <span class="comment">//  数据获取成功</span></span><br><span class="line">        .<span class="property">then</span> (<span class="function"><span class="params">result</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                <span class="attr">swiperList</span>: result.<span class="property">data</span>.<span class="property">message</span></span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="将小程序请求的域名添加到后台"><a href="#将小程序请求的域名添加到后台" class="headerlink" title="将小程序请求的域名添加到后台"></a>将小程序请求的域名添加到后台</h2><ol>
<li>进入 <code>微信公众平台</code></li>
<li>开发</li>
<li>开发设置</li>
<li>服务器域名</li>
<li>添加request合法域名</li>
</ol>
<h2 id="获取本地存储的数据"><a href="#获取本地存储的数据" class="headerlink" title="获取本地存储的数据"></a>获取本地存储的数据</h2><p><strong>web中的本地存储 和 小程序中的本地存储的区别：</strong></p>
<ol>
<li>写代码的方式不一样<ol>
<li>web中：<ol>
<li>存储方式：localStorage.setItem(“key”, “value”);</li>
<li>获取方式： localStorage.getItem(“key”);</li>
</ol>
</li>
<li>小程序中：<ol>
<li>存储方式：wx.setStorageSync(“key”, “value”);</li>
<li>获取方式：wx.getStorageSync(“key”, “value”);</li>
</ol>
</li>
</ol>
</li>
<li>存的时候 有没有做类型转换<ol>
<li>web：不管存的数据是什么类型的数据，最后都会通过toString（）方法转换为字符串类型的数据</li>
<li>小程序：不存在数据的类型转换</li>
</ol>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 接口返回的数据</span></span><br><span class="line"><span class="title class_">Cates</span>: [],</span><br><span class="line"><span class="attr">onLoad</span>: <span class="keyword">function</span>(<span class="params">options</span>) &#123;</span><br><span class="line">    <span class="comment">// 获取本地存储中有没有旧数据</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title class_">Cates</span> = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;cate&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 判断本地是否存在</span></span><br><span class="line">    <span class="keyword">if</span>(!<span class="title class_">Case</span>) &#123;</span><br><span class="line">        <span class="comment">// 不存在  发送请求数据</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">setCates</span>();</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 有旧的数据</span></span><br><span class="line">        <span class="comment">// 定义数据过期的时间</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="title class_">Date</span>.<span class="title function_">now</span>() - <span class="title class_">Cates</span>.<span class="property">time</span> &gt; <span class="number">1000</span> * <span class="number">10</span>) &#123;</span><br><span class="line">           <span class="comment">// 重新发送请求</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">getCates</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">Cates</span> = <span class="title class_">Cates</span>.<span class="property">data</span>;</span><br><span class="line">            <span class="comment">// 渲染数据</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取请求的数据</span></span><br><span class="line"><span class="title function_">getCates</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 把接口的数据存储到本地存储中</span></span><br><span class="line">	wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;cates&quot;</span>, &#123;time：<span class="title class_">Date</span>.<span class="title function_">now</span>(),<span class="attr">data</span>: <span class="variable language_">this</span>.<span class="property">Cates</span>&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="定义公共的url"><a href="#定义公共的url" class="headerlink" title="定义公共的url"></a>定义公共的url</h2><p>在request.js文件中，封装请求方法</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">request</span>=(<span class="params">params</span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// 定义公共的url</span></span><br><span class="line">    <span class="keyword">const</span> baseUrl = <span class="string">&quot;https://api.zbsb.cn/api/public&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        wx.<span class="title function_">request</span>(&#123;</span><br><span class="line">            <span class="comment">// 解构传递的参数</span></span><br><span class="line">            ...params,</span><br><span class="line">            <span class="attr">url</span>: baseUrl + params.<span class="property">url</span>;</span><br><span class="line">            <span class="attr">success</span>: <span class="function">(<span class="params">result</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="title function_">resolve</span>(result);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">faile</span>: <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">            	<span class="title function_">reject</span>(err);</span><br><span class="line">        	&#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="小程序支持es7的async语法"><a href="#小程序支持es7的async语法" class="headerlink" title="小程序支持es7的async语法"></a>小程序支持es7的async语法</h2><ol>
<li><p>在微信开发者工具中勾选<code>es6转es5语法</code></p>
</li>
<li><p>在github里面下载regenerator库中的runtime.js</p>
</li>
<li><p>在小程序目录文件下新建文件夹&#x2F;lib&#x2F;runtime&#x2F;runtime.js，将代码拷贝进去</p>
</li>
<li><p>在每一个需要使用async语法的页面js文件中，引入文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> regeneratorRuntime <span class="keyword">from</span> <span class="string">&#x27;../lib/runtime/runtime&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>使用asyn语法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="title function_">getCates</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 1 使用es7的async await来发送请求</span></span><br><span class="line">    <span class="keyword">const</span> res=<span class="keyword">await</span> <span class="title function_">request</span>(&#123;<span class="attr">url</span>:<span class="string">&quot;/categories&quot;</span>&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="小程序url传参"><a href="#小程序url传参" class="headerlink" title="小程序url传参"></a>小程序url传参</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// 传递参数</span><br><span class="line"><span class="tag">&lt;<span class="name">navigator</span> <span class="attr">wx:for</span>=<span class="string">&quot;Cates&quot;</span> <span class="attr">wx:for-item</span>=<span class="string">&quot;item&quot;</span> <span class="attr">wx:for-index</span>=<span class="string">&quot;index&quot;</span> <span class="attr">wx:key</span>=<span class="string">&quot;id&quot;</span> <span class="attr">url</span>=<span class="string">&quot;/pages/goods/index?cid=&#123;&#123;item.cid&#125;&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line"></span><br><span class="line">// 拿取参数</span><br><span class="line">onLoad：function(options) &#123;</span><br><span class="line">	consol.log(options);  // 打印输出options的值</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="封装tab切换组件"><a href="#封装tab切换组件" class="headerlink" title="封装tab切换组件"></a>封装tab切换组件</h2><p>封装的Tab组件中：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">properties</span>: &#123;</span><br><span class="line">    <span class="attr">tabs</span>: <span class="title class_">Array</span>,</span><br><span class="line">    <span class="attr">value</span>: []</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line">    .<span class="property">tabs</span>-title &#123;</span><br><span class="line">     	<span class="attr">display</span>: flex;</span><br><span class="line">        <span class="attr">padding</span>: 15rpx <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">	.<span class="property">title</span>-item &#123;</span><br><span class="line">        <span class="attr">display</span>: flex;</span><br><span class="line">        justify-<span class="attr">content</span>: center;</span><br><span class="line">        align-<span class="attr">item</span>: center;</span><br><span class="line">        <span class="attr">flex</span>: <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">	.<span class="property">active</span> &#123;</span><br><span class="line">        <span class="attr">color</span>: red;</span><br><span class="line">        border-<span class="attr">bottom</span>: 1rpx solid red;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;tabs&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;tabs-title&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    	<span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:for</span>=<span class="string">&quot;&#123;&#123; tabs &#125;&#125;&quot;</span> <span class="attr">wx:key</span>=<span class="string">&quot;id&quot;</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">		<span class="attr">class</span>=<span class="string">&quot;title-item &#123;&#123;item.isActive?&#x27;active&#x27;:&#x27;&#x27;&#125;&#125;&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">		<span class="attr">bindtap</span>=<span class="string">&quot;handleItemTap&quot;</span>  <span class="attr">data-index</span>=<span class="string">&quot;&#123;&#123; index &#125;&#125;&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">		&gt;</span>   </span></span><br><span class="line"><span class="language-xml">            &#123;&#123; item.value &#125;&#125;</span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">	// 切换内容</span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;tabs-content&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    	<span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="comment">// 点击事件</span></span><br><span class="line">    <span class="title function_">handleItemTap</span>(<span class="params">e</span>) &#123;</span><br><span class="line">        <span class="comment">// 获取点击的索引</span></span><br><span class="line">        <span class="keyword">const</span> &#123;index&#125; = e.<span class="property">currentTarget</span>.<span class="property">dataset</span>;</span><br><span class="line">        <span class="comment">// 触发父组件中的事件</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">triggerEvent</span>(<span class="string">&quot;tabsItemChange&quot;</span>, &#123;index&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用封装的Tab组件：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">//bindtabsItemChange 监听自定义事件</span><br><span class="line"><span class="tag">&lt;<span class="name">Tab</span> <span class="attr">tabs</span>=<span class="string">&quot;&#123;&#123; tabs &#125;&#125;&quot;</span> <span class="attr">bindtabsItemChange</span>=<span class="string">&quot;handelTabsItemChange&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">block</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;tabs[0].isActive&#125;&#125;&quot;</span>&gt;</span>1<span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">block</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;tabs[1].isActive&#125;&#125;&quot;</span>&gt;</span>2<span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">block</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;tabs[2].isActive&#125;&#125;&quot;</span>&gt;</span>3<span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Tab</span>&gt;</span></span><br><span class="line"></span><br><span class="line">// 标题的点击事件</span><br><span class="line">bindtabsItemChange(e) &#123;</span><br><span class="line">  // 获取被点击的标题的索引</span><br><span class="line">  const &#123;index&#125; = e.detail;</span><br><span class="line">  // 修改原数组</span><br><span class="line">  let &#123;tabs&#125; = this.data;</span><br><span class="line">  tabs.forEach((v,i)=&gt;i===index?v.isActive=true:v.isActive=false);</span><br><span class="line">  // 赋值到data中</span><br><span class="line">  this.setData(&#123;</span><br><span class="line">    tabs</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="滚动条触底事件（页面上滑事件）"><a href="#滚动条触底事件（页面上滑事件）" class="headerlink" title="滚动条触底事件（页面上滑事件）"></a>滚动条触底事件（页面上滑事件）</h2><p>滚动条触底，加载下一页数据</p>
<p>总页数 &#x3D; Math.ceil(总条数 &#x2F; 每页显示的数据数)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取商品数据列表</span></span><br><span class="line"><span class="keyword">async</span> <span class="title function_">getGoodsList</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> res=<span class="keyword">await</span> <span class="title function_">request</span>(&#123;<span class="attr">url</span>:<span class="string">&quot;/goods/search&quot;</span>,<span class="attr">data</span>:<span class="variable language_">this</span>.<span class="property">QueryParams</span>&#125;);</span><br><span class="line">    <span class="comment">// 获取总条数</span></span><br><span class="line">    <span class="keyword">const</span> total = res.<span class="property">total</span>;</span><br><span class="line">    <span class="comment">// 计算总页数</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">totalPage</span> = <span class="title class_">Math</span>.<span class="title function_">ceil</span>(total / <span class="variable language_">this</span>.<span class="property">QueryParams</span>.<span class="property">pagesize</span>);</span><br><span class="line">    <span class="comment">// 拼接数组</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">        <span class="attr">goodsList</span>: [...<span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">goodsList</span>,...res.<span class="property">goods</span>]</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// 关闭下拉刷新的窗口</span></span><br><span class="line">    wx-<span class="title function_">stopDownRefresh</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 滚动条触底事件</span></span><br><span class="line"><span class="title function_">onReachBottom</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 判断还有没有下一页数据</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="property">QueryParams</span>.<span class="property">pagenum</span> &gt;= <span class="variable language_">this</span>.<span class="property">totalPage</span>) &#123;</span><br><span class="line">        <span class="comment">// 当前页码 &gt; 总页数    没有下一页</span></span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 还有下一页  当前页码++ 重新发送请求  数据请求回来后要对data中的数组进行拼接</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">QueryParams</span>.<span class="property">pagenum</span>++；</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">getGoodsList</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="下拉刷新页面"><a href="#下拉刷新页面" class="headerlink" title="下拉刷新页面"></a>下拉刷新页面</h2><ol>
<li>触发下拉刷新事件（需要在页面的json文件中开启一个配置项）【enablePullDownRefresh: true,backgroundTextStyle: dark】</li>
<li>重置 数据 数组</li>
<li>重置页码 设置为1</li>
<li>重新发送请求</li>
<li>数据请求成功，手动关闭等待效果</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">onPullDownRefresh</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 重置  数据  数组</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">        <span class="attr">goodsList</span>: []</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// 重置页码   设置为1</span></span><br><span class="line">     <span class="variable language_">this</span>.<span class="property">QueryParams</span>.<span class="property">pagenum</span>=<span class="number">1</span>;</span><br><span class="line">    <span class="comment">// 重新发送请求</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">getGoodsList</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="wx-showModel改变this的指向问题"><a href="#wx-showModel改变this的指向问题" class="headerlink" title="wx.showModel改变this的指向问题"></a>wx.showModel改变this的指向问题</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">wx.<span class="title function_">showModel</span>(&#123;</span><br><span class="line">    <span class="attr">title</span>: <span class="string">&#x27;提示&#x27;</span>,</span><br><span class="line">    <span class="attr">content</span>: <span class="string">&#x27;您是否要删除？&#x27;</span>,</span><br><span class="line">    success :<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="js中的删除"><a href="#js中的删除" class="headerlink" title="js中的删除"></a>js中的删除</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cart.<span class="title function_">splice</span>(index, <span class="number">1</span>);  <span class="comment">// 删除索引为index的元素</span></span><br><span class="line"></span><br><span class="line">cart.<span class="title function_">filter</span>(<span class="function"><span class="params">v</span> =&gt;</span> v.<span class="property">checked</span>);  <span class="comment">// 挑选出cart数组中checked为true的值</span></span><br></pre></td></tr></table></figure>

<h2 id="弹窗的封装"><a href="#弹窗的封装" class="headerlink" title="弹窗的封装"></a>弹窗的封装</h2><p><strong>在asyncWX.js文件中</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">showModel</span>=(<span class="params">&#123;content&#125;</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve,reject</span>) =&gt;</span> &#123;</span><br><span class="line">        wx.<span class="title function_">showModel</span>(&#123;</span><br><span class="line">            <span class="attr">title</span>: <span class="string">&#x27;提示&#x27;</span>,</span><br><span class="line">            <span class="attr">content</span>: content,</span><br><span class="line">            success :(res) &gt; &#123;</span><br><span class="line">                <span class="title function_">resolve</span>(res);</span><br><span class="line">            &#125;,</span><br><span class="line">            fail :<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="title function_">reject</span>(err);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>使用</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;showModel&#125; <span class="keyword">from</span> <span class="string">&#x27;../../utils/asyncWx.js&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="title function_">showTips</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> res=<span class="keyword">await</span> <span class="title function_">showModel</span>(&#123;<span class="attr">content</span>: <span class="string">&#x27;您是否要删除？&#x27;</span>&#125;)</span><br><span class="line">    <span class="keyword">if</span>(res.<span class="property">confirm</span>) &#123;</span><br><span class="line">       cart.<span class="title function_">splice</span>(index, <span class="number">1</span>);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">setData</span>(cart);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="获取缓存中的数据"><a href="#获取缓存中的数据" class="headerlink" title="获取缓存中的数据"></a>获取缓存中的数据</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;address&quot;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="微信支付"><a href="#微信支付" class="headerlink" title="微信支付"></a>微信支付</h2><ol>
<li>企业账号</li>
<li>在企业账号的小程序后台中 必须 给 开发者添加上白名单<ol>
<li>一个AppID可以绑定多个开发者</li>
<li>绑定之后的开发者就拥有了开发者的权限了</li>
</ol>
</li>
<li>支付按钮<ol>
<li>先判断缓存中有没有token</li>
<li>没有 跳转到授权页面 获取用户的 token 值</li>
<li>有 执行支付操作</li>
</ol>
</li>
</ol>
<p><strong>流程：创建订单，准备预支付，发起微信支付，查询订单</strong></p>
<p><strong>一，获取token</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">handleOrderPay</span>(<span class="params"></span>) &#123;</span><br><span class="line">   <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 1. 判断缓存中有没有token值</span></span><br><span class="line">        <span class="keyword">const</span> token = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;token&quot;</span>);</span><br><span class="line">        <span class="comment">// 2. 判断</span></span><br><span class="line">        <span class="keyword">if</span>(!token) &#123;</span><br><span class="line">            <span class="comment">// 跳转到  授权 页面</span></span><br><span class="line">            wx.<span class="title function_">navigateTo</span>(&#123;</span><br><span class="line">                <span class="attr">url</span>: <span class="string">&quot;/page/auth/index&quot;</span></span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 3. 创建订单</span></span><br><span class="line">        <span class="comment">// 准备创建订单需要的参数</span></span><br><span class="line">        <span class="keyword">const</span> header = &#123;<span class="title class_">Authorization</span>:token&#125;;</span><br><span class="line">        <span class="comment">// 准备请求体参数</span></span><br><span class="line">        <span class="keyword">const</span> order_price = <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">totalPrice</span>;   <span class="comment">// 订单总价格</span></span><br><span class="line">        <span class="keyword">const</span> consignee = <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">address</span>.<span class="property">all</span>;  <span class="comment">// 详细地址</span></span><br><span class="line">        <span class="keyword">let</span> goods = [];</span><br><span class="line">        <span class="keyword">const</span> cart = <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">cart</span>;</span><br><span class="line">        goods.<span class="title function_">forEach</span>(<span class="function"><span class="params">v</span> =&gt;</span> goods.<span class="title function_">push</span>(&#123;</span><br><span class="line">            <span class="attr">goods_Id</span>: v.<span class="property">goods_Id</span>, <span class="comment">// 商品的id</span></span><br><span class="line">            <span class="attr">goods_number</span>: v.<span class="property">goods_number</span>, <span class="comment">//商品数量</span></span><br><span class="line">            <span class="attr">goods_price</span>: v.<span class="property">goods_price</span>  <span class="comment">// 商品的单价</span></span><br><span class="line">        &#125;))</span><br><span class="line">        <span class="keyword">const</span> orderParams = &#123;order_price,consignee,goods&#125;</span><br><span class="line">        <span class="comment">// 4. 准备发送请求  创建订单  获取订单编号</span></span><br><span class="line">        <span class="keyword">const</span> &#123;order_number&#125;=<span class="keyword">await</span> <span class="title function_">request</span>(&#123;<span class="attr">url</span>: 				     <span class="string">&quot;/order/create&quot;</span>&#125;,<span class="attr">method</span>:<span class="string">&quot;POST&quot;</span>,<span class="attr">data</span>:orderParams,<span class="attr">head</span>:head&#125;);</span><br><span class="line">        <span class="comment">// 5. 发起 预支付接口</span></span><br><span class="line">        <span class="keyword">const</span> &#123;pay&#125;=<span class="keyword">await</span> <span class="title function_">request</span>(&#123;<span class="attr">url</span>:<span class="string">&quot;/order/req_unifiedorder&quot;</span>,<span class="attr">method</span>:<span class="string">&quot;POST&quot;</span>,head,<span class="attr">data</span>:&#123;order_number&#125;&#125;);</span><br><span class="line">        <span class="comment">// 6. 发起微信支付</span></span><br><span class="line">        <span class="keyword">await</span> <span class="title function_">requestPayment</span>(pay);</span><br><span class="line">        <span class="comment">// 7. 查询后台  订单状态是否成功</span></span><br><span class="line">        <span class="keyword">const</span> res=<span class="keyword">await</span> <span class="title function_">request</span>(<span class="attr">url</span>:<span class="string">&quot;/orders/chkOrder&quot;</span>,<span class="attr">method</span>:<span class="string">&quot;POST&quot;</span>,head,<span class="attr">data</span>:&#123;order_number&#125;&#125;);</span><br><span class="line">		<span class="comment">// 提示支付成功</span></span><br><span class="line">		<span class="keyword">await</span> <span class="title function_">showToast</span>(&#123;<span class="attr">title</span>:<span class="string">&quot;支付成功&quot;</span>&#125;);</span><br><span class="line">		<span class="comment">// 手动删除 缓存中支付成功购物车的数据</span></span><br><span class="line">		<span class="keyword">let</span> newCart = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;cart&quot;</span>);</span><br><span class="line">		<span class="comment">// 过滤出没有被选中的数据</span></span><br><span class="line">		newCart = newCart.<span class="title function_">filter</span>(<span class="function"><span class="params">v</span> =&gt;</span> !v.<span class="property">checked</span>);</span><br><span class="line">		wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;cart&quot;</span>,newCart);</span><br><span class="line">		<span class="comment">// 8.支付成功  跳转到订单页面</span></span><br><span class="line">		wx.<span class="title function_">navigateTo</span>(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">&#x27;/page/order/index&#x27;</span></span><br><span class="line">        &#125;)</span><br><span class="line">   &#125; <span class="keyword">catch</span>(err) &#123;</span><br><span class="line">       <span class="keyword">await</span> <span class="title function_">showToast</span>(&#123;<span class="attr">title</span>:<span class="string">&quot;支付失败&quot;</span>&#125;);</span><br><span class="line">   &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>page&#x2F;autn&#x2F;index页面中：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">open-type</span>=<span class="string">&quot;getUserInfo&quot;</span> <span class="attr">bindgetUserInfo</span>=<span class="string">&quot;handleGetUserInfo&quot;</span>&gt;</span></span><br><span class="line">    获取授权</span><br><span class="line"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">复制代码</span><br><span class="line">// 获取用户信息</span><br><span class="line">// encryptedData  </span><br><span class="line">// rawData</span><br><span class="line">// iv</span><br><span class="line">// signature</span><br><span class="line">async handleGetUserInfo(e) &#123;</span><br><span class="line">    try &#123;</span><br><span class="line">        // 获取用户信息</span><br><span class="line">        const &#123; encryptedData,rawData,iv,signature &#125; = e.detail;</span><br><span class="line">        // 获取小程序登录之后的token值  在asyncWX.js中封装token请求方法</span><br><span class="line">        // wx.login(&#123;</span><br><span class="line">        //     timeout: 1000,</span><br><span class="line">        //    success: (result) =&gt; &#123;</span><br><span class="line">        //     	cost &#123; code &#125; = result;   </span><br><span class="line">        //    &#125;</span><br><span class="line">        // &#125;)</span><br><span class="line">        const &#123;code&#125; = await login();</span><br><span class="line">        const loginParams = &#123; encryptedData, rawData, iv, signature, code &#125;</span><br><span class="line">        // 发送请求  获取用户的token</span><br><span class="line">        const &#123;token&#125;=await request(url: &#x27;/user/wxlogin&#x27;,data: loginParams,methods: 		&quot;post&quot;);</span><br><span class="line">        // 将获取到的token存储到缓存中，同时跳转回上一个界面</span><br><span class="line">        wx.getStroageSync(&quot;token&quot;, token);</span><br><span class="line">        wx.navigateBack(&#123;</span><br><span class="line">            data: 1 // 返回上一层</span><br><span class="line">        &#125;)    </span><br><span class="line">    &#125; catch(err) &#123;</span><br><span class="line">    	console.log(err);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在<code>asyncWX.js</code>文件中封装支付方法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">requestPayment</span>=(<span class="params">pay</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>((resolve,reject)&#123;</span><br><span class="line">    	wx.<span class="title function_">request</span>(&#123;</span><br><span class="line">           ...pay,</span><br><span class="line">           <span class="attr">success</span>: <span class="function">(<span class="params">result</span>) =&gt;</span> &#123;</span><br><span class="line">        		<span class="title function_">resolve</span>(result);</span><br><span class="line">    	   &#125;,</span><br><span class="line">           <span class="attr">fail</span>: <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">               <span class="title function_">reject</span>(err);</span><br><span class="line">           &#125;</span><br><span class="line">        &#125;)                   </span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>二，准备预支付（获取参数 pay）</strong></p>
<p><strong>三，发起微信支付（提交pay参数）</strong></p>
<p><strong>四，查询订单</strong></p>
<p><strong>五，删除缓存中已经被选中购买的商品</strong></p>
<p><strong>六，删除后的购物车数据 填充会缓存</strong></p>
<p><strong>七，跳转页面</strong></p>
<h2 id="图片上传（wx-uploadFile）"><a href="#图片上传（wx-uploadFile）" class="headerlink" title="图片上传（wx.uploadFile）"></a>图片上传（wx.uploadFile）</h2><p>图片上传的时候，存储上传的图片的时候，要先拼接上之前的图片。</p>
<p>chooseImage：[],</p>
<p>this.setData({</p>
<p> <em>chooseImage: [上传之前的图片组, 上传的图片组]</em></p>
<p> chooseImage: […this.data.chooseImage, …chooseImage]</p>
<p>})</p>
<p><strong>上传文件的api不支持多个文件同时上传</strong></p>
<p><strong>解决方法：遍历数组 挨个上传</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">wx.<span class="title function_">uploadFile</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 图片要上传到哪里</span></span><br><span class="line">    <span class="attr">filePath</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 被上传文件的路径</span></span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;&#x27;</span>,  <span class="comment">// 上传的文件的名称  后台通过定义的上传的名称来获取名称</span></span><br><span class="line">    <span class="attr">formData</span>: &#123;&#125;, <span class="comment">// 顺带的文本信息</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h1 id="项目发布"><a href="#项目发布" class="headerlink" title="项目发布"></a>项目发布</h1><p>**注意：发布之前记得关闭详情界面的 <em>不校验合法域名</em> **</p>
<p>上传的每个文件大小不超过2M，总大小不超过10M。</p>
<p>上传：</p>
<ol>
<li>版本号<ol>
<li>第一个数字（大版本的更新）</li>
<li>第二个数字（重要功能更新）</li>
<li>第三个数字（最小功能，小bug，小补丁）</li>
</ol>
</li>
<li>less文件是不会被打包上传的</li>
<li>上传成功后的小程序还是一个体验版本的小程序，如果需要将体验版本的小程序变成线上版本的小程序，就在 <strong>微信公众平台</strong>将提交的体验本的小程序，<strong>提交审核</strong>（审核的时间大概是一个小时）。</li>
</ol>
<h1 id="小程序插件"><a href="#小程序插件" class="headerlink" title="小程序插件"></a>小程序插件</h1><ol>
<li>小程序开发助手</li>
</ol>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ecc34da8c8ea43eb9ed1131f0fa6f3b6~tplv-k3u1fbpfcp-watermark.awebp" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-7znr3gju-1594264046886)(/Users/cly/Library/Application Support/typora-user-images/image-20200707145006263.png)]"></p>
<ol>
<li>安装easy less插件</li>
</ol>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6193f6cf333743c2986a16a737d697ca~tplv-k3u1fbpfcp-watermark.awebp" alt="在这里插入图片描述"> </p>
<p>在vscode中配置(ctrl + shift + p 然后输入 setting，然后添加上如下配置)：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;less.compile&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;outExit&quot;</span>: <span class="string">&quot;.wxss&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/03/01/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/" data-id="cl083ym890002w8tfhrq533hz" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-wod" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/03/01/wod/" class="article-date">
  <time class="dt-published" datetime="2022-03-01T11:34:10.000Z" itemprop="datePublished">2022-03-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/03/01/wod/">wod</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/03/01/wod/" data-id="cl083ym800001w8tfba4ycmux" data-title="wod" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-hello-world" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/03/01/hello-world/" class="article-date">
  <time class="dt-published" datetime="2022-03-01T11:28:16.512Z" itemprop="datePublished">2022-03-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/03/01/hello-world/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Welcome to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a target="_blank" rel="noopener" href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a target="_blank" rel="noopener" href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/03/01/hello-world/" data-id="cl083ym7w0000w8tffrmhdfgj" data-title="Hello World" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">March 2022</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/03/01/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/">(no title)</a>
          </li>
        
          <li>
            <a href="/2022/03/01/wod/">wod</a>
          </li>
        
          <li>
            <a href="/2022/03/01/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2022 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>